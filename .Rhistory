range_step = 1000,
mixcoeff = o$coeff)[,2],
n_africa = mixdist(age_mean = o.n_africa$age_mean,
age_sd = o.n_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = o.n_africa$coeff)[,2],
ce_africa = mixdist(age_mean = o.ce_africa$age_mean,
age_sd = o.ce_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = o.ce_africa$coeff)[,2],
s_africa = mixdist(age_mean = o.s_africa$age_mean,
age_sd = o.s_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = o.s_africa$coeff)[,2]
) %>% pivot_longer(-c(age), names_to = 'var', values_to = 'val')
dist.ochre.region$var <- factor(dist.ochre.region$var, levels=c('n_africa', 'ce_africa', 's_africa', 'overall'))
View(dist.ochre.region)
l.n_africa <- l %>% filter(region=='N Africa') %>% select(age_mean,age_sd, coeff)
# Clean lithic data
l <- l_data %>% drop_na(query_age_min, query_age_max) %>%
mutate(age_mean = (query_age_min+query_age_max)/2,  # Calculate age mean
age_difference = query_age_max-query_age_min,   # Calculate age age_difference
age_sd=(age_difference)/2.65) %>%               # calculate age standard deviation, assuming our range covers p=0.99
unite('uid', c(assemblage.locality_idlocality, assemblage.name)) %>%
add_count(uid, name = 'split_assemblage') %>%
mutate(coeff = 1/length(unique(uid))/split_assemblage) %>%
mutate(region = case_when(locality.y > 23.5 ~ 'N Africa',
locality.y <= 23.5 & locality.y >= -23.5 ~ 'C+E Africa',
locality.y < -23.5 ~ 'S Africa')) %>%
mutate(region = factor(region, levels = c('N Africa', 'C+E Africa', 'S Africa')))
l.n_africa <- l %>% filter(region=='N Africa') %>% select(age_mean,age_sd, coeff)
l.ce_africa <- l %>% filter(region=='S Africa') %>% select(age_mean,age_sd, coeff)
l.s_africa <- l %>% filter(region=='C+E Africa') %>% select(age_mean,age_sd, coeff)
dist.lithics.region <- data.frame(age=seq(40000,500000,1000),
overall = mixdist(age_mean = lo$age_mean,
age_sd = l$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l$coeff)[,2],
n_africa = mixdist(age_mean = l.n_africa$age_mean,
age_sd = l.n_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.n_africa$coeff)[,2],
ce_africa = mixdist(age_mean = l.ce_africa$age_mean,
age_sd = l.ce_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.ce_africa$coeff)[,2],
s_africa = mixdist(age_mean = l.s_africa$age_mean,
age_sd = l.s_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.s_africa$coeff)[,2]
) %>% pivot_longer(-c(age), names_to = 'var', values_to = 'val')
dist.lithics.region <- data.frame(age=seq(40000,500000,1000),
overall = mixdist(age_mean = l$age_mean,
age_sd = l$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l$coeff)[,2],
n_africa = mixdist(age_mean = l.n_africa$age_mean,
age_sd = l.n_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.n_africa$coeff)[,2],
ce_africa = mixdist(age_mean = l.ce_africa$age_mean,
age_sd = l.ce_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.ce_africa$coeff)[,2],
s_africa = mixdist(age_mean = l.s_africa$age_mean,
age_sd = l.s_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.s_africa$coeff)[,2]
) %>% pivot_longer(-c(age), names_to = 'var', values_to = 'val')
saveRDS(dist.ochre.regions, 'work/dist.ochre.region.rds')
saveRDS(dist.ochre.region, 'work/dist.ochre.region.rds')
dist.lithics.region$var <- factor(dist.lithics.region$var, levels=c('n_africa', 'ce_africa', 's_africa', 'overall'))
View(dist.lithics.region)
saveRDS(dist.lithics.region, 'work/dist.ochre.region.rds')
library(tidyverse)
library(readxl)
library(tidyverse)
set.seed(2020)
# Load data
o_data <- read_delim("data/all_ochre_dates.csv", ";", escape_double = FALSE, trim_ws = TRUE)  # ochre
l_data <- read_delim("data/all_lithics_dates.csv", ";", escape_double = FALSE, trim_ws = TRUE)  # lithics
# Clean ochre data
o <- o_data %>% mutate(age_mean = (query_age_min+query_age_max)/2, # Calculate age mean
age_difference = query_age_max-query_age_min,   # Calculate age age_difference
age_sd=(age_difference)/2.65) %>%               # calculate age standard deviation, assuming our range covers p=0.99
unite('uid', c(assemblage.locality_idlocality, assemblage.name)) %>%
add_count(uid, name = 'split_assemblage') %>%
mutate(coeff = 1/length(unique(uid))/split_assemblage) %>%
mutate(region = case_when(locality.y > 23.5 ~ 'N Africa',
locality.y <= 23.5 & locality.y >= -23.5 ~ 'C+E Africa',
locality.y < -23.5 ~ 'S Africa')) %>%
mutate(region = factor(region, levels = c('N Africa', 'C+E Africa', 'S Africa')))
# Clean lithic data
l <- l_data %>% drop_na(query_age_min, query_age_max) %>%
mutate(age_mean = (query_age_min+query_age_max)/2,  # Calculate age mean
age_difference = query_age_max-query_age_min,   # Calculate age age_difference
age_sd=(age_difference)/2.65) %>%               # calculate age standard deviation, assuming our range covers p=0.99
unite('uid', c(assemblage.locality_idlocality, assemblage.name)) %>%
add_count(uid, name = 'split_assemblage') %>%
mutate(coeff = 1/length(unique(uid))/split_assemblage) %>%
mutate(region = case_when(locality.y > 23.5 ~ 'N Africa',
locality.y <= 23.5 & locality.y >= -23.5 ~ 'C+E Africa',
locality.y < -23.5 ~ 'S Africa')) %>%
mutate(region = factor(region, levels = c('N Africa', 'C+E Africa', 'S Africa')))
# Load theme
theme_ochre <- readRDS('work/theme_ochre.rds')
# Gaussian mixture distribution
mixdist <- function(age_mean, age_sd, mixcoeff=vector(), range_min, range_max, range_step){
## Create list with normal distribution fuctions Norm() from the package distr
require(distr)
dist_list = list() # Create a list to be filled with the for loop
for(i in seq(1,length(age_mean),1)){
val <- distr::Norm(mean=age_mean[i],sd=age_sd[i])
dist_list <- append(dist_list, val)
}
dist_list <- DistrList(Dlist=dist_list) # Create a DistrList from the list of individual Norm Dists
## Combinte the individual Norm distributions to a mixed distribution. The mixcoefficient compensates the effect of multiple dates per assemblage
if(length(mixcoeff)==0){
mix_dist <- UnivarMixingDistribution(Dlist = dist_list)
}else{
mix_dist <- UnivarMixingDistribution(Dlist = dist_list, mixCoeff = mixcoeff)
}
## Create a table with densities
mix_dist_table<-data.frame(age = seq(range_min,range_max,range_step),
density = mix_dist@d(seq(range_min,range_max,range_step)))
return(mix_dist_table)
}
saveRDS(mixdist, 'work/mixdist_function.rds')
# Smoothing function
smoothdist <- function(data,smoothing_list){
require(pracma)
for(i in smoothing_list){
data[,paste0("smooth", i)] <- movavg(data$density, n=i, type = 's')
}
return(data)
}
saveRDS(smoothdist, 'work/smoothdist_function.rds')
# Calculate mixture distribution
dist.ochre <- mixdist(age_mean = o$age_mean,
age_sd = o$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = o$coeff)
saveRDS(dist.ochre, 'work/dist.ochre.rds')
dist.lithics <- mixdist(age_mean = l$age_mean,
age_sd = l$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l$coeff)
saveRDS(dist.lithics, 'work/dist.lithics.rds')
# Calculate regional mixture distributions
## Regional subsets
o.n_africa <- o %>% filter(region=='N Africa') %>% select(age_mean,age_sd, coeff)
o.ce_africa <- o %>% filter(region=='S Africa') %>% select(age_mean,age_sd, coeff)
o.s_africa <- o %>% filter(region=='C+E Africa') %>% select(age_mean,age_sd, coeff)
l.n_africa <- l %>% filter(region=='N Africa') %>% select(age_mean,age_sd, coeff)
l.ce_africa <- l %>% filter(region=='S Africa') %>% select(age_mean,age_sd, coeff)
l.s_africa <- l %>% filter(region=='C+E Africa') %>% select(age_mean,age_sd, coeff)
## Calculate regional distributions
dist.ochre.region <- data.frame(age=seq(40000,500000,1000),
overall = mixdist(age_mean = o$age_mean,
age_sd = o$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = o$coeff)[,2],
n_africa = mixdist(age_mean = o.n_africa$age_mean,
age_sd = o.n_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = o.n_africa$coeff)[,2],
ce_africa = mixdist(age_mean = o.ce_africa$age_mean,
age_sd = o.ce_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = o.ce_africa$coeff)[,2],
s_africa = mixdist(age_mean = o.s_africa$age_mean,
age_sd = o.s_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = o.s_africa$coeff)[,2]
) %>% pivot_longer(-c(age), names_to = 'var', values_to = 'val')
dist.ochre.region$var <- factor(dist.ochre.region$var, levels=c('n_africa', 'ce_africa', 's_africa', 'overall'))
saveRDS(dist.ochre.region, 'work/dist.ochre.region.rds')
dist.lithics.region <- data.frame(age=seq(40000,500000,1000),
overall = mixdist(age_mean = l$age_mean,
age_sd = l$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l$coeff)[,2],
n_africa = mixdist(age_mean = l.n_africa$age_mean,
age_sd = l.n_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.n_africa$coeff)[,2],
ce_africa = mixdist(age_mean = l.ce_africa$age_mean,
age_sd = l.ce_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.ce_africa$coeff)[,2],
s_africa = mixdist(age_mean = l.s_africa$age_mean,
age_sd = l.s_africa$age_sd,
range_min = 40000,
range_max = 500000,
range_step = 1000,
mixcoeff = l.s_africa$coeff)[,2]
) %>% pivot_longer(-c(age), names_to = 'var', values_to = 'val')
dist.lithics.region$var <- factor(dist.lithics.region$var, levels=c('n_africa', 'ce_africa', 's_africa', 'overall'))
saveRDS(dist.lithics.region, 'work/dist.ochre.region.rds')
# The effect of smoothing
## Apply smoothing
dist.ochre.smoothed <- smoothdist(data = dist.ochre, smoothing_list = c(5,10,15,20,30,40))
saveRDS(dist.ochre.smoothed, 'work/dist.ochre.smoothed.rds')
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
View(dist.ochre.smoothed)
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
geom_line(dist.lithics, aes(x=age, y=density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
geom_line(date=dist.lithics, aes(x=age, y=density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
View(dist.lithics)
View(dist.ochre)
View(dist.ochre.smoothed)
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
geom_line(aes(x=dist.lithics$age, y=dist.lithics$density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
#geom_line(aes(x=dist.lithics$age, y=dist.lithics$density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
geom_line(aes(x=dist.lithics$age, y=dist.lithics$density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
geom_area(aes(x=dist.lithics$age, y=dist.lithics$density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
geom_curve(aes(x=dist.lithics$age, y=dist.lithics$density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
geom_line(aes(x=dist.lithics$age, y=dist.lithics$density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(dist.lithics)
ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
geom_point(aes(x=dist.lithics$age, y=dist.lithics$density))+
theme_ochre()+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(dist.lithics)
library(tidyverse)
library(patchwork)
mixdist <- readRDS('work/mixdist_function.rds')
library(tidyverse)
library(patchwork)
mixdist <- readRDS('work/mixdist_function.rds')
r <- data.frame(age=seq(0,10,0.01),
d1 = mixdist(age_mean = 2,
age_sd = 0.5,
range_min = 0,
range_max = 10,
range_step = 0.01)[,2],
d2 = mixdist(age_mean = 5,
age_sd = 1.5,
range_min = 0,
range_max = 10,
range_step = 0.01)[,2],
d3 = mixdist(age_mean = c(7,8,8.5),
age_sd = c(0.3,0.3,0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3,1/3,1/3))[,2],
d4 = mixdist(age_mean = c(2,5,7,8,8.5),
age_sd = c(0.5,1.5,0.5,0.5,0.5),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3,1/3,1/9,1/9,1/9))[,2],
d5 = mixdist(age_mean = c(7),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3,
d6 = mixdist(age_mean = c(8),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3,
d7 = mixdist(age_mean = c(8.5),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3
)
p1<- ggplot()+
geom_errorbarh(aes(y=1, xmin=2-0.5*2.65, xmax=2+0.5*2.65, color='Type A',height = .02))+
geom_errorbarh(aes(y=0.88, xmin=5-1.5*2.65, xmax=5+1.5*2.65, color='Type B',height = .02))+
geom_errorbarh(aes(y=1, xmin=7-0.3*2.65, xmax=7+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.96, xmin=8-0.3*2.65, xmax=8+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.92, xmin=8.5-0.3*2.65, xmax=8.5+0.3*2.65, color='Type C',height = .02))+
guides(color=FALSE)+
labs(x='', y='Age range')+
scale_x_continuous(limits=c(0,10))+
theme_void()+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
p1<- ggplot()+
geom_errorbarh(aes(y=1, xmin=2-0.5*2.65, xmax=2+0.5*2.65, color='Type A',height = .02))+
geom_errorbarh(aes(y=0.88, xmin=5-1.5*2.65, xmax=5+1.5*2.65, color='Type B',height = .02))+
geom_errorbarh(aes(y=1, xmin=7-0.3*2.65, xmax=7+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.96, xmin=8-0.3*2.65, xmax=8+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.92, xmin=8.5-0.3*2.65, xmax=8.5+0.3*2.65, color='Type C',height = .02))+
guides(color='none')+
labs(x='', y='Age range')+
scale_x_continuous(limits=c(0,10))+
theme_void()+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
plot(p1)
p2<- ggplot(r, aes(x=age))+
geom_area(aes(y=d1, fill='Type A', color='Type A'),alpha=0.5)+
geom_area(aes(y=d2, fill='Type B', color='Type B'),alpha=0.5)+
geom_area(aes(y=d5, fill='Type C', color='Type C'),alpha=0.5)+
geom_area(aes(y=d6, fill='Type C', color='Type C'),alpha=0.5)+
geom_area(aes(y=d7, fill='Type C', color='Type C'),alpha=0.5)+
geom_line(aes(y=d4,linetype = "Mixed density"))+
guides(color=FALSE, fill=guide_legend("Date types"), linetype=guide_legend(""))+
labs(x='Time', y='Density')+
scale_x_continuous(limits=c(0,10))+
theme_bw()+
theme(
axis.text.x = element_blank(),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
legend.position="right")
p2<- ggplot(r, aes(x=age))+
geom_area(aes(y=d1, fill='Type A', color='Type A'),alpha=0.5)+
geom_area(aes(y=d2, fill='Type B', color='Type B'),alpha=0.5)+
geom_area(aes(y=d5, fill='Type C', color='Type C'),alpha=0.5)+
geom_area(aes(y=d6, fill='Type C', color='Type C'),alpha=0.5)+
geom_area(aes(y=d7, fill='Type C', color='Type C'),alpha=0.5)+
geom_line(aes(y=d4,linetype = "Mixed density"))+
guides(color='none', fill=guide_legend("Date types"), linetype=guide_legend(""))+
labs(x='Time', y='Density')+
scale_x_continuous(limits=c(0,10))+
theme_bw()+
theme(
axis.text.x = element_blank(),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
legend.position="right")
plot(p2)
plt <- p2/p1+plot_layout(heights = c(6, 1))
plot(plt)
View(r)
ggsave("results/theoretical_background.tiff", width = 17.4, height = 7, units = 'cm', dpi=400)
