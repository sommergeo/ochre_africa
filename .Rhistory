labeller = labeller(var=region.labs))+
scale_fill_manual(name='',
breaks = c('Lithics','Ochre'),
values = c('#A4A3A9','#A51E37'),
labels = c('Lithics', 'Ochre'))+
scale_color_manual(name='',
breaks = c('Lithics','Ochre'),
values = c('#32414B','#A51E37'),
labels = c('Lithics', 'Ochre'))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(y='Density')+
theme_ochre()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_regional)
# Plot benthic isotopes
plt_benthic_isotope <- ggplot(data=benthic_isotope, aes(x=age, y=mean))+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se), fill='grey80')+
geom_line(aes(color=mean))+
scale_x_continuous(x_scale)+
scale_y_reverse(limits=c(5,3))+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
labs(x='Age (ka BP)',
y='Benthic d18O (???)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())+
guides(color=guide_colorbar(ticks=FALSE, reverse=T, label=F))
# Plot benthic isotopes
plt_benthic_isotope <- ggplot(data=benthic_isotope, aes(x=age, y=mean))+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se), fill='grey80')+
geom_line(aes(color=mean))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
scale_y_reverse(limits=c(5,3))+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
labs(x='Age (ka BP)',
y='Benthic d18O (???)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())+
guides(color=guide_colorbar(ticks=FALSE, reverse=T, label=F))
plot(plt_benthic_isotope)
# Plot benthic isotopes
plt_benthic_isotope <- ggplot(data=benthic_isotope, aes(x=age, y=mean))+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se), fill='grey80')+
geom_line(aes(color=mean))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
scale_y_reverse(limits=c(5,3))+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
labs(x='Age (ka BP)',
y='Benthic d18O (???)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_benthic_isotope)
# Plot benthic isotopes
plt_benthic_isotope <- ggplot(data=benthic_isotope, aes(x=age, y=mean))+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se), fill='grey80')+
geom_line(aes(color=mean))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
scale_y_reverse(limits=c(5,3))+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
labs(x='Age (ka BP)',
y='Benthic d18O (‰)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_benthic_isotope)
# Plot Insolation
lt_insolation <- ggplot(data=insolation, aes(x=age, y=val, linetype=month, color=var)) +
geom_line()+
scale_color_manual(name='',
breaks = c('N30','S30'),
#values = c('#D29600', '#C8503C'),
values = c('#415A8C', '#AF6E96'),
labels = c('Northern Summer','Southern Summer'))+
scale_linetype_manual(name='',
breaks = c('Jun 21st','Dec 21st'),
#values = c('dashed', 'solid'),
values = c('solid', 'solid'),
labels = c('Northern Summer','Southern Summer'))+
scale_x_continuous(limits = c(30000,150000),
breaks = seq(0,500000, 20000),
labels = function(x) format(x/1000, scientific = FALSE))+
labs(x='Age ka BP',
y='Insolation (W/m?)')+
theme_bw() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
plot(plt_insolation)
# Plot Insolation
plt_insolation <- ggplot(data=insolation, aes(x=age, y=val, linetype=month, color=var)) +
geom_line()+
scale_color_manual(name='',
breaks = c('N30','S30'),
#values = c('#D29600', '#C8503C'),
values = c('#415A8C', '#AF6E96'),
labels = c('Northern Summer','Southern Summer'))+
scale_linetype_manual(name='',
breaks = c('Jun 21st','Dec 21st'),
#values = c('dashed', 'solid'),
values = c('solid', 'solid'),
labels = c('Northern Summer','Southern Summer'))+
scale_x_continuous(limits = c(30000,150000),
breaks = seq(0,500000, 20000),
labels = function(x) format(x/1000, scientific = FALSE))+
labs(x='Age ka BP',
y='Insolation (W/m?)')+
theme_bw() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
plot(plt_insolation)
rm(lt_insolation)
# Plot Insolation
plt_insolation <- ggplot(data=insolation, aes(x=age, y=val, linetype=month, color=var)) +
geom_line()+
scale_color_manual(name='',
breaks = c('N30','S30'),
#values = c('#D29600', '#C8503C'),
values = c('#415A8C', '#AF6E96'),
labels = c('Northern Summer','Southern Summer'))+
scale_linetype_manual(name='',
breaks = c('Jun 21st','Dec 21st'),
#values = c('dashed', 'solid'),
values = c('solid', 'solid'),
labels = c('Northern Summer','Southern Summer'))+
scale_x_continuous(limits = c(30000,150000),
breaks = seq(0,500000, 20000),
labels = function(x) format(x/1000, scientific = FALSE))+
labs(x='Age ka BP',
y='Insolation (W/m²)')+
theme_bw() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
plot(plt_insolation)
# Plot Insolation
plt_insolation <- ggplot(data=insolation, aes(x=age, y=val, linetype=month, color=var)) +
geom_line()+
scale_color_manual(name='',
breaks = c('N30','S30'),
#values = c('#D29600', '#C8503C'),
values = c('#415A8C', '#AF6E96'),
labels = c('Northern Summer','Southern Summer'))+
scale_linetype_manual(name='',
breaks = c('Jun 21st','Dec 21st'),
#values = c('dashed', 'solid'),
values = c('solid', 'solid'),
labels = c('Northern Summer','Southern Summer'))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Insolation (W/m²)')+
theme_bw() +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
plot(plt_insolation)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()
plot(plt_cliamte)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()
plot(plt_cliamte)
plot(plt_climate)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()+
scale_y_reverse()
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()+
scale_y_reverse()
plot(plt_climate)
# Plot Insolation
plt_insolation <- ggplot(data=insolation, aes(x=age, y=val, linetype=month, color=var)) +
geom_line()+
scale_color_manual(name='',
breaks = c('N30','S30'),
#values = c('#D29600', '#C8503C'),
values = c('#415A8C', '#AF6E96'),
labels = c('Northern Summer','Southern Summer'))+
scale_linetype_manual(name='',
breaks = c('Jun 21st','Dec 21st'),
#values = c('dashed', 'solid'),
values = c('solid', 'solid'),
labels = c('Northern Summer','Southern Summer'))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Insolation (W/m²)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_insolation)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
View(pan_african_climate)
pan_african_climate <- read_excel("data/pnas.2018277118.sd01.xlsx", sheet = "PCA Scores") %>% rename(age=`Age (ka)`) %>% mutate(age=age*1000) # Baboth-Barh et al. (2021), Proc. Natl. Acad. Sci. U.S.A.
saveRDS(pan_african_climate, 'work/pan_african_climate.rds')
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Pan-African Climate')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Pan-African Climate')+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Pan-African Climate')+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1, color=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Pan-African Climate')+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
scale_color_gradient2_tableau()
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1, color=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Pan-African Climate')+
scale_color_gradient2_tableau(palette = "Orange-Blue Diverging", name='')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1, color=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Pan-African Climate')+
scale_color_gradient2_tableau(palette = "Green-Blue Diverging", name='')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
# Combine all plots
plt_regional <- plt_regional/plt_benthic_isotope/plt_insolation/plt_climate+plot_layout(heights = c(1, 0.4, 0.4, 0.4))
plot(plt_climate)
plot(plt_regional)
ggsave('results/ochre_regional.tiff', width = 17.4, height = 16, units = 'cm', dpi=600)
# Plot benthic isotopes
plt_benthic_isotope <- ggplot(data=benthic_isotope, aes(x=age, y=mean))+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se), fill='grey80')+
geom_line(aes(color=mean))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
#scale_y_reverse(limits=c(5,3))+
scale_y_reverse()+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
labs(x='Age (ka BP)',
y='Benthic d18O (‰)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_benthic_isotope)
# Combine all plots
plt_regional <- plt_regional/plt_benthic_isotope/plt_insolation/plt_climate+plot_layout(heights = c(1, 0.4, 0.4, 0.4))
plot(plt_regional)
ggsave('results/ochre_regional.tiff', width = 17.4, height = 16, units = 'cm', dpi=600)
# Plot benthic isotopes
plt_benthic_isotope <- ggplot(data=benthic_isotope, aes(x=age, y=mean))+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se), fill='grey80')+
geom_line(aes(color=mean))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
scale_y_reverse(limits=c(5.5,3))+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
labs(x='Age (ka BP)',
y='Benthic d18O (‰)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_benthic_isotope)
# Plot benthic isotopes
plt_benthic_isotope <- ggplot(data=benthic_isotope, aes(x=age, y=mean))+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se), fill='grey80')+
geom_line(aes(color=mean))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
scale_y_reverse(limits=c(5.2,3))+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
labs(x='Age (ka BP)',
y='Benthic d18O (‰)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_benthic_isotope)
# Plot benthic isotopes
plt_benthic_isotope <- ggplot(data=benthic_isotope, aes(x=age, y=mean))+
geom_ribbon(aes(ymin=mean-se, ymax=mean+se), fill='grey80')+
geom_line(aes(color=mean))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
scale_y_reverse(limits=c(5.1,3))+
scale_color_gradient2_tableau(palette = "Red-Blue Diverging", name='')+
labs(x='Age (ka BP)',
y='Benthic d18O (‰)')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_benthic_isotope)
# Combine all plots
plt_regional <- plt_regional/plt_benthic_isotope/plt_insolation/plt_climate+plot_layout(heights = c(1, 0.4, 0.4, 0.4))
plot(plt_regional)
plot(plt_climate)
plot(plt_insolation)
plot(plt_benthic_isotope)
plot(plt_regional)
plt_regional <- ggplot()+
geom_area(data=dist.lithics.region, aes(x=age,y=val, fill='Lithics', color='Lithics'), alpha=.6)+
geom_area(data=dist.ochre.region, aes(x=age,y=val, fill='Ochre', color='Ochre'), alpha=.6)+
facet_grid(var~.,
labeller = labeller(var=region.labs))+
scale_fill_manual(name='',
breaks = c('Lithics','Ochre'),
values = c('#A4A3A9','#A51E37'),
labels = c('Lithics', 'Ochre'))+
scale_color_manual(name='',
breaks = c('Lithics','Ochre'),
values = c('#32414B','#A51E37'),
labels = c('Lithics', 'Ochre'))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Density')+
theme_ochre()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_regional)
# Combine all plots
plt_regional <- plt_regional/plt_benthic_isotope/plt_insolation/plt_climate+plot_layout(heights = c(1, 0.4, 0.4, 0.4))
plot(plt_regional)
plt_regional <- ggplot()+
geom_area(data=dist.lithics.region, aes(x=age,y=val, fill='Lithics', color='Lithics'), alpha=.6)+
geom_area(data=dist.ochre.region, aes(x=age,y=val, fill='Ochre', color='Ochre'), alpha=.6)+
facet_grid(var~.,
labeller = labeller(var=region.labs))+
scale_fill_manual(name='',
breaks = c('Lithics','Ochre'),
values = c('#A4A3A9','#A51E37'),
labels = c('Lithics', 'Ochre'))+
scale_color_manual(name='',
breaks = c('Lithics','Ochre'),
values = c('#32414B','#A51E37'),
labels = c('Lithics', 'Ochre'))+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Density')+
theme_ochre()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
# Combine all plots
plt_ochre_climate <- plt_regional/plt_benthic_isotope/plt_insolation/plt_climate+plot_layout(heights = c(1, 0.4, 0.4, 0.4))
plot(plt_ochre_climate)
ggsave('results/ochre_climate.tiff', width = 17.4, height = 16, units = 'cm', dpi=400)
plot(plt_ochre_climate)
ggsave('results/ochre_climate.tiff', width = 17.4, height = 23.4, units = 'cm', dpi=600)
# Combine all plots
plt_ochre_climate <- plt_regional/plt_benthic_isotope/plt_insolation/plt_climate+plot_layout(heights = c(1, 0.3, 0.3, 0.3))
plot(plt_ochre_climate)
ggsave('results/ochre_climate.tiff', width = 17.4, height = 23.4, units = 'cm', dpi=600)
# Combine all plots
plt_ochre_climate <- plt_regional/plt_insolation/plt_climate/plt_benthic_isotope+plot_layout(heights = c(1, 0.3, 0.3, 0.3))
plot(plt_ochre_climate)
ggsave('results/ochre_climate.tiff', width = 17.4, height = 23.4, units = 'cm', dpi=600)
# Plot pan_african_climate
plt_climate <- ggplot(data=pan_african_climate, aes(x=age, y=PC1, color=PC1)) +
geom_line()+
scale_y_reverse()+
scale_x_continuous(limits=regional_limits, breaks=regional_breaks, labels=regional_labels)+
labs(x='Age ka BP',
y='Hydroclimate')+
scale_color_gradient2_tableau(palette = "Green-Blue Diverging", name='')+
theme_ochre()+
theme(legend.position = "none",
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
strip.background = element_blank(),
strip.text.x = element_blank())
plot(plt_climate)
# Combine all plots
plt_ochre_climate <- plt_regional/plt_insolation/plt_climate/plt_benthic_isotope+plot_layout(heights = c(1, 0.3, 0.3, 0.3))
plot(plt_ochre_climate)
ggsave('results/ochre_climate.tiff', width = 17.4, height = 23.4, units = 'cm', dpi=600)
