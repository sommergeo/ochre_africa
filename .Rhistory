scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(0,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(0,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(limits=c(0,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(0,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x/1000, scientific = FALSE))+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(0,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','longdash','longdash','longdash','longdash','longdash','longdash'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
ggsave("work/ochre_density_smoothing.tiff", width = 8.4, height = 10, units = 'cm', dpi=400)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom",
labs(x='Age ka BP',
y='Density'))
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age ka BP',
y='Density')
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age ka BP', y='Density')+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age (ka BP)', y='Density')+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="bottom")
plot(plt_smoothing)
ggsave("work/ochre_density_smoothing.tiff", width = 8.4, height = 10, units = 'cm', dpi=400)
plot(plt_smoothing)
ggsave("work/ochre_density_smoothing.tiff", width = 8.4, height = 10, units = 'cm', dpi=400)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age (ka BP)', y='Density')+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="right")
plot(plt_smoothing)
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age (ka BP)', y='Density')+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="right")
plot(plt_smoothing)
plot(plt_smoothing)
ggsave("work/ochre_density_smoothing.tiff", width = 17.4, height = 10, units = 'cm', dpi=400)
ggsave("results/ochre_density_smoothing.tiff", width = 17.4, height = 10, units = 'cm', dpi=400)
ggsave("results/ochre_density_smoothing.tiff", width = 17.4, height = 8, units = 'cm', dpi=400)
#### Theme ----
theme_ochre <-  function(){
list(theme_bw(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=10), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=10), #change font size of legend text
legend.title=element_text(size=10)))
}
#### Plot dating uncertainties
plt_smoothing <- ggplot()+
geom_line(data=dist.lithics, aes(x=age, y=density))+
geom_line(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var))
#### Plot dating uncertainties
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age (ka BP)', y='Density')+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="right")
#### Plot dating uncertainties
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age (ka BP)', y='Density')+
scale_color_discrete(name='Smoothing interval (ka)',
values=c('black','red','red','red','red','red','red'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="right")
plot(plt_smoothing)
#### Plot dating uncertainties
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age (ka BP)', y='Density')+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('none',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="right")
plot(plt_smoothing)
ggsave("results/ochre_density_smoothing.tiff", width = 17.4, height = 8, units = 'cm', dpi=400)
ggsave("results/ochre_density_smoothing.tiff", width = 17.4, height = 8, units = 'cm', dpi=600)
ggsave("results/ochre_age_ranges_climate.tiff", width = 8.4, height = 8.4, units = 'cm', dpi=600)
plot(plt_date_scatter)
ggsave("results/ochre_age_ranges_climate.tiff", width = 8.4, height = 8.4, units = 'cm', dpi=600)
library(tidyverse)
library(patchwork)
mixdist <- readRDS('work/mixdist_function.rds')
r <- data.frame(age=seq(0,10,0.01),
d1 = mixdist(age_mean = 2,
age_sd = 0.5,
range_min = 0,
range_max = 10,
range_step = 0.01)[,2],
d2 = mixdist(age_mean = 5,
age_sd = 1.5,
range_min = 0,
range_max = 10,
range_step = 0.01)[,2],
d3 = mixdist(age_mean = c(7,8,8.5),
age_sd = c(0.3,0.3,0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3,1/3,1/3))[,2],
d4 = mixdist(age_mean = c(2,5,7,8,8.5),
age_sd = c(0.5,1.5,0.5,0.5,0.5),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3,1/3,1/9,1/9,1/9))[,2],
d5 = mixdist(age_mean = c(7),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3,
d6 = mixdist(age_mean = c(8),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3,
d7 = mixdist(age_mean = c(8.5),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3
)
#### Theme ----
theme_ochre <-  function(){
list(theme_bw(),
theme(text=element_text(size=8), #change font size of all text
axis.text=element_text(size=8), #change font size of axis text
axis.title=element_text(size=10), #change font size of axis titles
plot.title=element_text(size=8), #change font size of plot title
legend.text=element_text(size=10), #change font size of legend text
legend.title=element_text(size=10)))
}
saveRDS(theme_ochre, 'work/theme_ochre.rds')
theme_ochre <- readRDS('work/theme_ochre.rds')
r <- data.frame(age=seq(0,10,0.01),
d1 = mixdist(age_mean = 2,
age_sd = 0.5,
range_min = 0,
range_max = 10,
range_step = 0.01)[,2],
d2 = mixdist(age_mean = 5,
age_sd = 1.5,
range_min = 0,
range_max = 10,
range_step = 0.01)[,2],
d3 = mixdist(age_mean = c(7,8,8.5),
age_sd = c(0.3,0.3,0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3,1/3,1/3))[,2],
d4 = mixdist(age_mean = c(2,5,7,8,8.5),
age_sd = c(0.5,1.5,0.5,0.5,0.5),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3,1/3,1/9,1/9,1/9))[,2],
d5 = mixdist(age_mean = c(7),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3,
d6 = mixdist(age_mean = c(8),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3,
d7 = mixdist(age_mean = c(8.5),
age_sd = c(0.3),
range_min = 0,
range_max = 10,
range_step = 0.01,
mixcoeff = c(1/3))[,2]/3
)
p1<- ggplot()+
geom_errorbarh(aes(y=1, xmin=2-0.5*2.65, xmax=2+0.5*2.65, color='Type A',height = .02))+
geom_errorbarh(aes(y=0.88, xmin=5-1.5*2.65, xmax=5+1.5*2.65, color='Type B',height = .02))+
geom_errorbarh(aes(y=1, xmin=7-0.3*2.65, xmax=7+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.96, xmin=8-0.3*2.65, xmax=8+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.92, xmin=8.5-0.3*2.65, xmax=8.5+0.3*2.65, color='Type C',height = .02))+
guides(color='none')+
labs(x='', y='Age range')+
scale_x_continuous(limits=c(0,10))+
theme_void()+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
p1<- ggplot()+
geom_errorbarh(aes(y=1, xmin=2-0.5*2.65, xmax=2+0.5*2.65, color='Type A',height = .02))+
geom_errorbarh(aes(y=0.88, xmin=5-1.5*2.65, xmax=5+1.5*2.65, color='Type B',height = .02))+
geom_errorbarh(aes(y=1, xmin=7-0.3*2.65, xmax=7+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.96, xmin=8-0.3*2.65, xmax=8+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.92, xmin=8.5-0.3*2.65, xmax=8.5+0.3*2.65, color='Type C',height = .02))+
guides(color='none')+
labs(x='', y='Age range')+
scale_x_continuous(limits=c(0,10))+
theme_ochre()+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
plot(p1)
p1<- ggplot()+
geom_errorbarh(aes(y=1, xmin=2-0.5*2.65, xmax=2+0.5*2.65, color='Type A',height = .02))+
geom_errorbarh(aes(y=0.88, xmin=5-1.5*2.65, xmax=5+1.5*2.65, color='Type B',height = .02))+
geom_errorbarh(aes(y=1, xmin=7-0.3*2.65, xmax=7+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.96, xmin=8-0.3*2.65, xmax=8+0.3*2.65, color='Type C',height = .02))+
geom_errorbarh(aes(y=0.92, xmin=8.5-0.3*2.65, xmax=8.5+0.3*2.65, color='Type C',height = .02))+
guides(color='none')+
labs(x='', y='Age range')+
scale_x_continuous(limits=c(0,10))+
theme_void()+
theme(
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank())
plot(p1)
p2<- ggplot(r, aes(x=age))+
geom_area(aes(y=d1, fill='Type A', color='Type A'),alpha=0.5)+
geom_area(aes(y=d2, fill='Type B', color='Type B'),alpha=0.5)+
geom_area(aes(y=d5, fill='Type C', color='Type C'),alpha=0.5)+
geom_area(aes(y=d6, fill='Type C', color='Type C'),alpha=0.5)+
geom_area(aes(y=d7, fill='Type C', color='Type C'),alpha=0.5)+
geom_line(aes(y=d4,linetype = "Mixed density"))+
guides(color='none', fill=guide_legend("Date types"), linetype=guide_legend(""))+
labs(x='Time', y='Density')+
scale_x_continuous(limits=c(0,10))+
theme_bw()+
theme(
axis.text.x = element_blank(),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
legend.position="right")
plot(p2)
p2<- ggplot(r, aes(x=age))+
geom_area(aes(y=d1, fill='Type A', color='Type A'),alpha=0.5)+
geom_area(aes(y=d2, fill='Type B', color='Type B'),alpha=0.5)+
geom_area(aes(y=d5, fill='Type C', color='Type C'),alpha=0.5)+
geom_area(aes(y=d6, fill='Type C', color='Type C'),alpha=0.5)+
geom_area(aes(y=d7, fill='Type C', color='Type C'),alpha=0.5)+
geom_line(aes(y=d4,linetype = "Mixed density"))+
guides(color='none', fill=guide_legend("Date types"), linetype=guide_legend(""))+
labs(x='Time', y='Density')+
scale_x_continuous(limits=c(0,10))+
theme_ochre()+
theme(
axis.text.x = element_blank(),
#axis.text.y = element_blank(),
axis.ticks.x = element_blank(),
legend.position="right")
plot(p2)
plt <- p2/p1+plot_layout(heights = c(6, 1))
plot(plt)
ggsave("results/theoretical_background.tiff", width = 17.4, height = 7, units = 'cm', dpi=600)
ggsave("results/theoretical_background.tiff", width = 17.4, height = 8, units = 'cm', dpi=600)
#### Plot dating uncertainties
plt_smoothing <- ggplot(data=dist.ochre.smoothed %>%
pivot_longer(-c(age), names_to = 'var', values_to = 'val'),
aes(x=age, y=val, color=var, linetype=var)) +
geom_line() +
theme_ochre()+
scale_x_continuous(limits=c(50000,500000),
labels = function(x) format(x/1000, scientific = FALSE))+
scale_y_continuous(labels = function(x) format(x, scientific = FALSE))+
labs(x='Age (ka BP)', y='Density')+
scale_color_discrete(name='Smoothing interval (ka)',
labels=c('None',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
scale_linetype_manual(name='Smoothing interval (ka)',
values=c('solid','solid','solid','solid','solid','solid','solid'),
labels=c('None',5,10,15,20,30,40),
breaks=c("density",'smooth5','smooth10','smooth15','smooth20','smooth30','smooth40'))+
guides(colour = guide_legend(title.position = "top"))+
theme(legend.position="right")
plot(plt_smoothing)
ggsave("results/ochre_density_smoothing.tiff", width = 17.4, height = 8, units = 'cm', dpi=600)
